################################################################################
# Simulates A Gaussian Process 
################################################################################

################################################################################
# Settings
# Libraries

# Dimensions
D <- 1
# Grid Size
grid_size <- rep(1, D)
# Number of Points
N <- 1000
# Variance
s2 <- 1
r  <- 100
################################################################################

################################################################################
# Point Locations
S <- matrix(data = NA, nrow = N, ncol = D)
for(n in 1:N){
  for(d in 1:D){
    S[n, d] <- runif(grid_size[d])
  }
}
################################################################################

################################################################################
# Distance Matrix
DM <- matrix(data = 0, nrow = N, ncol = N)
for(n in 1:N){
  for(nn in 1:N){
    DM[n, nn] <- sqrt(sum((S[n, ] - S[nn, ])^2))
  }
}
################################################################################

################################################################################
# Simulates
# Covariance Matrix
C <- s2 * exp(- DM / r)
# Simulates Observations
y <- as.vector(mvtnorm::rmvnorm(n = 1, sigma = C))
################################################################################
# Plots
if(D == 1){
  ymax <-   s2 * 4
  ymin <- - s2 * 4
  o <- order(S[,1])
  plot(x    = S[,1][o],
       y    = y[o],
       ylim = c(ymin, ymax),
       type = 'l')
}

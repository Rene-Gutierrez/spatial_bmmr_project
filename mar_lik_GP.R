################################################################################
# Marginal Likelihood Gaussian Process
################################################################################

mar_lik_GP <- function(s2,
                       t2,
                       l2,
                       y,
                       DM){
  ##############################################################################
  # Dimensions
  # Number of Observations
  N   <- length(y)
  ##############################################################################
  
  ##############################################################################
  # Loglikelihood
  # Covariance Function
  K   <- t2 * exp(- DM / (2 * l2))
  # Loglikelihood
  log <-     - N * log(2 * pi) / 2
  log <- log - log(det(K + s2 * diag(nrow = N))) / 2
  log <- log - t(y) %*% solve(K + s2 * diag(nrow = N), y) / 2
  ##############################################################################
  
  ##############################################################################
  # Returns
  return(log)
  ##############################################################################
}
################################################################################
# Marginal Likelihood Gaussian Process
################################################################################

tra_mar_lik_GP <- function(ls2,
                           lt2,
                           ll2,
                           y,
                           DM){
  ##############################################################################
  # Dimensions
  # Number of Observations
  N   <- length(y)
  ##############################################################################
  
  ##############################################################################
  # Transforms the variables
  s2 <- exp(ls2)
  t2 <- exp(lt2)
  l2 <- exp(ll2)
  ##############################################################################
  
  ##############################################################################
  # Loglikelihood
  # Covariance Function
  K   <- t2 * exp(- DM / (2 * l2))
  # Loglikelihood
  log <-     - N * log(2 * pi) / 2
  log <- log - log(det(K + s2 * diag(nrow = N))) / 2
  log <- log - t(y) %*% solve(K + s2 * diag(nrow = N), y) / 2
  log <- log + ls2 + lt2 + ll2
  ##############################################################################
  
  ##############################################################################
  # Returns
  return(log)
  ##############################################################################
}